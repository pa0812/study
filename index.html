<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>英语单词听写工具</title>
    <style>
        :root {
            --primary-color: #4CAF50;
            --primary-hover: #45a049;
            --secondary-color: #2196F3;
            --secondary-hover: #1e88e5;
            --warning-color: #FFC107;
            --warning-hover: #ffb300;
            --danger-color: #f44336;
            --danger-hover: #d32f2f;
            --success-color: #4CAF50;
            --correct-color: #e0ffe0;
            --incorrect-color: #ffe0e0;
            --border-radius: 8px;
            --box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            --transition: all 0.3s ease;
        }
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            color: #333;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            font-size: 16px;
            line-height: 1.6;
            padding: 20px;
        }
        
        .container {
            background-color: white;
            padding: 30px;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            max-width: 700px;
            width: 100%;
            text-align: center;
            transition: var(--transition);
        }
        
        h1 {
            margin-bottom: 20px;
            color: #2c3e50;
            font-weight: 600;
        }
        
        .form-group {
            margin-bottom: 20px;
            text-align: left;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: #555;
        }
        
        textarea {
            width: 100%;
            height: 200px;
            padding: 15px;
            font-size: 1em;
            border: 1px solid #ddd;
            border-radius: var(--border-radius);
            resize: vertical;
            transition: var(--transition);
            font-family: inherit;
        }
        
        textarea:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 2px rgba(76, 175, 80, 0.2);
        }
        
        input[type="number"], input[type="checkbox"] {
            margin: 0 10px 0 0;
            font-size: 1em;
        }
        
        input[type="number"] {
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: var(--border-radius);
            width: 80px;
        }
        
        .checkbox-group {
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 15px 0;
        }
        
        .button-group {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 25px;
            flex-wrap: wrap;
        }
        
        button {
            padding: 12px 25px;
            border: none;
            border-radius: var(--border-radius);
            cursor: pointer;
            font-size: 1em;
            font-weight: 500;
            transition: var(--transition);
            min-width: 120px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        button:focus {
            outline: none;
            box-shadow: 0 0 0 3px rgba(76, 175, 80, 0.3);
        }
        
        .btn-primary {
            background-color: var(--primary-color);
            color: white;
        }
        
        .btn-primary:hover {
            background-color: var(--primary-hover);
        }
        
        .btn-secondary {
            background-color: var(--secondary-color);
            color: white;
        }
        
        .btn-secondary:hover {
            background-color: var(--secondary-hover);
        }
        
        .btn-warning {
            background-color: var(--warning-color);
            color: #333;
        }
        
        .btn-warning:hover {
            background-color: var(--warning-hover);
        }
        
        .btn-danger {
            background-color: var(--danger-color);
            color: white;
        }
        
        .btn-danger:hover {
            background-color: var(--danger-hover);
        }
        
        #meaning {
            font-size: 2.2em;
            margin: 25px 0;
            min-height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #2c3e50;
            font-weight: 500;
        }
        
        .input-group {
            position: relative;
            margin: 25px 0;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            flex-wrap: wrap;
        }
        
        #input {
            width: 100%;
            max-width: 400px;
            padding: 15px 20px;
            font-size: 1.3em;
            border: 2px solid #ddd;
            border-radius: var(--border-radius);
            text-align: center;
            transition: var(--transition);
        }
        
        #input:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(76, 175, 80, 0.2);
        }
        
        #timer {
            font-size: 1.5em;
            font-weight: 600;
            color: #ff4500;
            min-width: 60px;
            padding: 10px;
            background: #fff9f5;
            border-radius: var(--border-radius);
        }
        
        .timer-warning {
            color: var(--danger-color) !important;
            animation: pulse 1s infinite;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        .correct {
            border-color: var(--success-color) !important;
            background-color: var(--correct-color) !important;
        }
        
        .incorrect {
            border-color: var(--danger-color) !important;
            background-color: var(--incorrect-color) !important;
        }
        
        .progress-bar {
            width: 100%;
            height: 8px;
            background-color: #f0f0f0;
            border-radius: 4px;
            margin: 20px 0;
            overflow: hidden;
        }
        
        .progress {
            height: 100%;
            background-color: var(--primary-color);
            border-radius: 4px;
            transition: width 0.3s ease;
        }
        
        .stats {
            display: flex;
            justify-content: space-around;
            margin: 25px 0;
            flex-wrap: wrap;
            gap: 15px;
        }
        
        .stat-item {
            flex: 1;
            min-width: 120px;
            padding: 15px;
            background: #f9f9f9;
            border-radius: var(--border-radius);
        }
        
        .stat-value {
            font-size: 2em;
            font-weight: 700;
            margin: 5px 0;
        }
        
        .accuracy-high {
            color: var(--success-color);
        }
        
        .accuracy-medium {
            color: var(--warning-color);
        }
        
        .accuracy-low {
            color: var(--danger-color);
        }
        
        #result-list {
            text-align: left;
            margin: 25px 0;
            max-height: 300px;
            overflow-y: auto;
        }
        
        .result-item {
            margin: 10px 0;
            padding: 15px;
            background-color: #f9f9f9;
            border-radius: var(--border-radius);
            border-left: 4px solid #ddd;
        }
        
        .result-item.correct {
            border-left-color: var(--success-color);
        }
        
        .result-item.incorrect {
            border-left-color: var(--danger-color);
        }
        
        .word-display {
            font-weight: 600;
            margin-bottom: 5px;
        }
        
        .meaning-display {
            color: #666;
            font-size: 0.9em;
        }
        
        .hint {
            font-size: 0.9em;
            color: #777;
            margin-top: 10px;
        }
        
        .hidden {
            display: none;
        }
        
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 25px;
            border-radius: var(--border-radius);
            color: white;
            font-weight: 500;
            box-shadow: var(--box-shadow);
            z-index: 1000;
            transform: translateX(150%);
            transition: transform 0.3s ease;
        }
        
        .notification.show {
            transform: translateX(0);
        }
        
        .notification.success {
            background-color: var(--success-color);
        }
        
        .notification.error {
            background-color: var(--danger-color);
        }
        
        .notification.info {
            background-color: var(--secondary-color);
        }
        
        @media (max-width: 600px) {
            .container {
                padding: 20px;
            }
            
            h1 {
                font-size: 1.5em;
            }
            
            #meaning {
                font-size: 1.8em;
            }
            
            .input-group {
                flex-direction: column;
            }
            
            .button-group {
                flex-direction: column;
            }
            
            button {
                width: 100%;
            }
            
            .stats {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <!-- 通知区域 -->
    <div id="notification" class="notification"></div>
    
    <!-- 设置界面 -->
    <div class="container" id="setup">
        <h1>英语单词听写工具</h1>
        <div class="form-group">
            <label for="word-list">单词列表（每行一个单词，格式：单词 中文意思）</label>
            <textarea id="word-list" placeholder="例如：&#10;apple 苹果&#10;banana 香蕉&#10;computer 电脑"></textarea>
            <div class="hint">提示：可以输入单词和中文意思，用空格或Tab键分隔</div>
        </div>
        
        <div class="form-group">
            <label for="timer-setting">倒计时时间（秒）</label>
            <input type="number" id="timer-setting" value="30" min="10" max="120">
        </div>
        
        <div class="checkbox-group">
            <input type="checkbox" id="shuffle" checked>
            <label for="shuffle">打乱单词顺序</label>
        </div>
        
        <div class="button-group">
            <button id="start-btn" class="btn-primary">
                <span>开始听写</span>
            </button>
            <button id="example-btn" class="btn-secondary">
                <span>使用示例单词</span>
            </button>
        </div>
    </div>

    <!-- 听写界面 -->
    <div class="container hidden" id="dictation">
        <h1>单词听写</h1>
        
        <div class="progress-bar">
            <div class="progress" id="progress"></div>
        </div>
        
        <div id="meaning"></div>
        
        <div class="input-group">
            <button id="play-btn" class="btn-secondary">
                <span>播放发音</span>
            </button>
            <input type="text" id="input" placeholder="请输入单词拼写" autofocus>
            <div id="timer">30</div>
        </div>
        
        <div class="button-group">
            <button id="submit-btn" class="btn-primary">
                <span>提交答案</span>
            </button>
            <button id="skip-btn" class="btn-warning">
                <span>跳过此题</span>
            </button>
            <button id="quit-btn" class="btn-danger">
                <span>退出听写</span>
            </button>
        </div>
    </div>

    <!-- 结果界面 -->
    <div class="container hidden" id="results">
        <h1>听写结果</h1>
        
        <div class="stats">
            <div class="stat-item">
                <div>总题数</div>
                <div class="stat-value" id="total">0</div>
            </div>
            <div class="stat-item">
                <div>正确数</div>
                <div class="stat-value" id="correct">0</div>
            </div>
            <div class="stat-item">
                <div>错误数</div>
                <div class="stat-value" id="incorrect-count">0</div>
            </div>
            <div class="stat-item">
                <div>正确率</div>
                <div class="stat-value" id="accuracy">0%</div>
            </div>
        </div>
        
        <h2>答题详情</h2>
        <div id="result-list"></div>
        
        <div class="button-group">
            <button id="retry-btn" class="btn-primary">
                <span>再试一次</span>
            </button>
            <button id="back-btn" class="btn-secondary">
                <span>返回主页</span>
            </button>
        </div>
    </div>

    <script>
        // 应用状态管理
        const AppState = {
            words: [],
            currentIndex: 0,
            correctCount: 0,
            incorrect: [],
            timerInterval: null,
            remainingTime: 0,
            timerSetting: 30,
            shuffle: true,
            results: []
        };

        // DOM元素引用
        const DOM = {
            setup: document.getElementById('setup'),
            dictation: document.getElementById('dictation'),
            results: document.getElementById('results'),
            wordList: document.getElementById('word-list'),
            timerSetting: document.getElementById('timer-setting'),
            shuffle: document.getElementById('shuffle'),
            meaning: document.getElementById('meaning'),
            input: document.getElementById('input'),
            timer: document.getElementById('timer'),
            progress: document.getElementById('progress'),
            total: document.getElementById('total'),
            correct: document.getElementById('correct'),
            incorrectCount: document.getElementById('incorrect-count'),
            accuracy: document.getElementById('accuracy'),
            resultList: document.getElementById('result-list'),
            notification: document.getElementById('notification')
        };

        // 按钮引用
        const Buttons = {
            start: document.getElementById('start-btn'),
            example: document.getElementById('example-btn'),
            play: document.getElementById('play-btn'),
            submit: document.getElementById('submit-btn'),
            skip: document.getElementById('skip-btn'),
            quit: document.getElementById('quit-btn'),
            retry: document.getElementById('retry-btn'),
            back: document.getElementById('back-btn')
        };

        // 初始化应用
        function initApp() {
            setupEventListeners();
            loadExampleWords();
        }

        // 设置事件监听器
        function setupEventListeners() {
            Buttons.start.addEventListener('click', startDictation);
            Buttons.example.addEventListener('click', loadExampleWords);
            Buttons.play.addEventListener('click', playWord);
            Buttons.submit.addEventListener('click', submitAnswer);
            Buttons.skip.addEventListener('click', skipQuestion);
            Buttons.quit.addEventListener('click', quitDictation);
            Buttons.retry.addEventListener('click', retry);
            Buttons.back.addEventListener('click', backToSetup);
            
            DOM.input.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    submitAnswer();
                }
            });
            
            DOM.timerSetting.addEventListener('change', function() {
                const value = parseInt(this.value);
                if (value < 10) this.value = 10;
                if (value > 120) this.value = 120;
            });
        }

        // 加载示例单词
        function loadExampleWords() {
            const exampleWords = [
                "apple 苹果",
                "banana 香蕉",
                "computer 电脑",
                "education 教育",
                "beautiful 美丽的",
                "important 重要的",
                "restaurant 餐厅",
                "university 大学",
                "technology 技术",
                "communication 沟通"
            ].join('\n');
            
            DOM.wordList.value = exampleWords;
            showNotification('已加载示例单词列表', 'info');
        }

        // 显示通知
        function showNotification(message, type = 'info') {
            DOM.notification.textContent = message;
            DOM.notification.className = `notification ${type}`;
            DOM.notification.classList.add('show');
            
            setTimeout(() => {
                DOM.notification.classList.remove('show');
            }, 3000);
        }

        // 开始听写
        function startDictation() {
            const list = DOM.wordList.value.trim().split('\n');
            AppState.words = list.map(line => {
                // 支持空格和Tab分隔
                const parts = line.split(/\s+/);
                if (parts.length < 2) return null;
                
                return {
                    eng: parts[0].trim(),
                    chn: parts.slice(1).join(' ').trim()
                };
            }).filter(w => w !== null && w.eng && w.chn);

            if (AppState.words.length === 0) {
                showNotification('请输入有效的单词列表！', 'error');
                return;
            }

            AppState.timerSetting = parseInt(DOM.timerSetting.value) || 30;
            AppState.shuffle = DOM.shuffle.checked;

            if (AppState.shuffle) {
                AppState.words = shuffleArray(AppState.words);
            }

            AppState.currentIndex = 0;
            AppState.correctCount = 0;
            AppState.incorrect = [];
            AppState.results = [];

            showScreen('dictation');
            nextQuestion();
        }

        // 切换到下一个问题
        function nextQuestion() {
            if (AppState.currentIndex >= AppState.words.length) {
                showResults();
                return;
            }

            const word = AppState.words[AppState.currentIndex];
            DOM.meaning.textContent = word.chn;
            DOM.input.value = '';
            DOM.input.classList.remove('correct', 'incorrect');
            DOM.input.focus();

            // 更新进度条
            const progress = ((AppState.currentIndex) / AppState.words.length) * 100;
            DOM.progress.style.width = `${progress}%`;

            playWord();
            startTimer();
        }

        // 播放单词发音
        function playWord() {
            const word = AppState.words[AppState.currentIndex].eng;
            const utterance = new SpeechSynthesisUtterance(word);
            utterance.lang = 'en-US';
            utterance.rate = 0.9;
            speechSynthesis.speak(utterance);
        }

        // 开始计时器
        function startTimer() {
            AppState.remainingTime = AppState.timerSetting;
            DOM.timer.textContent = AppState.remainingTime;
            DOM.timer.classList.remove('timer-warning');
            
            clearInterval(AppState.timerInterval);
            AppState.timerInterval = setInterval(() => {
                AppState.remainingTime--;
                DOM.timer.textContent = AppState.remainingTime;
                
                // 最后5秒警告
                if (AppState.remainingTime <= 5) {
                    DOM.timer.classList.add('timer-warning');
                }
                
                if (AppState.remainingTime <= 0) {
                    handleIncorrect('超时');
                }
            }, 1000);
        }

        // 提交答案
        function submitAnswer() {
            const input = DOM.input.value.trim().toLowerCase();
            const word = AppState.words[AppState.currentIndex].eng.toLowerCase();

            clearInterval(AppState.timerInterval);

            if (input === word) {
                handleCorrect();
            } else {
                handleIncorrect('错误');
            }
        }

        // 处理正确答案
        function handleCorrect() {
            AppState.correctCount++;
            AppState.results.push({
                word: AppState.words[AppState.currentIndex],
                userInput: DOM.input.value,
                correct: true
            });
            
            DOM.input.classList.add('correct');
            showNotification('回答正确！', 'success');
            
            AppState.currentIndex++;
            setTimeout(nextQuestion, 1000);
        }

        // 处理错误答案
        function handleIncorrect(reason) {
            AppState.incorrect.push(AppState.words[AppState.currentIndex]);
            AppState.results.push({
                word: AppState.words[AppState.currentIndex],
                userInput: DOM.input.value,
                correct: false,
                reason: reason
            });
            
            DOM.input.classList.add('incorrect');
            DOM.input.value = AppState.words[AppState.currentIndex].eng; // 显示正确答案
            
            if (reason === '超时') {
                showNotification('时间到！', 'error');
            } else {
                showNotification('回答错误！', 'error');
            }
            
            AppState.currentIndex++;
            setTimeout(nextQuestion, 2000);
        }

        // 跳过问题
        function skipQuestion() {
            clearInterval(AppState.timerInterval);
            handleIncorrect('跳过');
        }

        // 退出听写
        function quitDictation() {
            if (confirm('确定要退出听写吗？当前进度将丢失。')) {
                clearInterval(AppState.timerInterval);
                showScreen('setup');
            }
        }

        // 显示结果
        function showResults() {
            showScreen('results');
            
            const total = AppState.words.length;
            const correct = AppState.correctCount;
            const incorrectCount = total - correct;
            const accuracy = Math.round((correct / total) * 100);
            
            DOM.total.textContent = total;
            DOM.correct.textContent = correct;
            DOM.incorrectCount.textContent = incorrectCount;
            DOM.accuracy.textContent = `${accuracy}%`;
            
            // 设置正确率颜色
            if (accuracy >= 80) {
                DOM.accuracy.classList.add('accuracy-high');
            } else if (accuracy >= 60) {
                DOM.accuracy.classList.add('accuracy-medium');
            } else {
                DOM.accuracy.classList.add('accuracy-low');
            }
            
            // 显示答题详情
            DOM.resultList.innerHTML = '';
            AppState.results.forEach((result, index) => {
                const item = document.createElement('div');
                item.className = `result-item ${result.correct ? 'correct' : 'incorrect'}`;
                
                item.innerHTML = `
                    <div class="word-display">${index + 1}. ${result.word.eng} - ${result.word.chn}</div>
                    <div>你的答案: ${result.userInput || '未作答'}</div>
                    ${!result.correct ? `<div>正确答案: ${result.word.eng}</div>` : ''}
                    ${result.reason ? `<div>原因: ${result.reason}</div>` : ''}
                `;
                
                DOM.resultList.appendChild(item);
            });
        }

        // 再试一次
        function retry() {
            if (AppState.shuffle) {
                AppState.words = shuffleArray(AppState.words);
            }
            
            AppState.currentIndex = 0;
            AppState.correctCount = 0;
            AppState.incorrect = [];
            AppState.results = [];
            
            showScreen('dictation');
            nextQuestion();
        }

        // 返回设置界面
        function backToSetup() {
            showScreen('setup');
        }

        // 显示指定屏幕
        function showScreen(screen) {
            DOM.setup.classList.add('hidden');
            DOM.dictation.classList.add('hidden');
            DOM.results.classList.add('hidden');
            
            document.getElementById(screen).classList.remove('hidden');
        }

        // 工具函数：打乱数组
        function shuffleArray(array) {
            const newArray = [...array];
            for (let i = newArray.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [newArray[i], newArray[j]] = [newArray[j], newArray[i]];
            }
            return newArray;
        }

        // 初始化应用
        document.addEventListener('DOMContentLoaded', initApp);
    </script>
</body>
</html>        #play-btn:hover {
            background-color: #1e88e5;
        }
        #skip-btn {
            background-color: #FFC107;
        }
        #skip-btn:hover {
            background-color: #ffb300;
        }
        #submit-btn {
            background-color: #4CAF50;
        }

        /* 响应式设计：适配手机端 */
        @media (max-width: 600px) {
            body {
                font-size: 1em;
                padding: 10px;
            }
            .container {
                padding: 15px;
            }
            #meaning {
                font-size: 1.5em;
            }
            #input {
                width: 100%;
                font-size: 1.2em;
                margin-bottom: 10px;
            }
            #timer {
                font-size: 1.2em;
                display: block; /* 计时器换行显示，避免错位 */
                margin: 10px 0;
            }
            button {
                width: 100%; /* 按钮全宽 */
                padding: 12px;
                font-size: 1em;
                margin: 5px 0;
            }
            textarea {
                height: 150px;
            }
        }
    </style>
</head>
<body>
    <div class="container" id="setup">
        <h1>设置界面</h1>
        <textarea id="word-list" placeholder="输入单词列表，每行一个，例如：&#10;apple 苹果&#10;banana 香蕉"></textarea>
        <label>倒计时（秒）：<input type="number" id="timer-setting" value="30" min="10"></label><br>
        <label>打乱顺序：<input type="checkbox" id="shuffle"></label><br>
        <button onclick="startDictation()">开始听写</button>
    </div>

    <div class="container" id="dictation" style="display: none;">
        <h1>听写界面</h1>
        <div id="meaning"></div>
        <button id="play-btn" onclick="playWord()">播放发音</button>
        <input type="text" id="input" placeholder="输入拼写" autofocus>
        <span id="timer"></span><br>
        <button id="submit-btn" onclick="submitAnswer()">提交</button>
        <button id="skip-btn" onclick="skipQuestion()">跳过</button>
    </div>

    <div class="container" id="results" style="display: none;">
        <h1>结果界面</h1>
        <p>总题数: <span id="total"></span></p>
        <p>正确数: <span id="correct"></span></p>
        <p>错误数: <span id="incorrect-count"></span></p>
        <p>正确率: <span id="accuracy"></span>%</p>
        <h2>错题回顾</h2>
        <div id="result-list"></div>
        <button onclick="retry()">再试一次</button>
        <button onclick="backToSetup()">返回主页</button>
    </div>

    <script>
        let words = [];
        let currentIndex = 0;
        let correctCount = 0;
        let incorrect = [];
        let timerInterval;
        let remainingTime;
        let timerSetting;
        let shuffle;

        function startDictation() {
            const list = document.getElementById('word-list').value.trim().split('\n');
            words = list.map(line => {
                const [eng, chn] = line.split(' ');
                return { eng, chn };
            }).filter(w => w.eng && w.chn);

            if (words.length === 0) {
                alert('请输入有效的单词列表！');
                return;
            }

            timerSetting = parseInt(document.getElementById('timer-setting').value) || 30;
            shuffle = document.getElementById('shuffle').checked;

            if (shuffle) {
                words = words.sort(() => Math.random() - 0.5);
            }

            currentIndex = 0;
            correctCount = 0;
            incorrect = [];

            document.getElementById('setup').style.display = 'none';
            document.getElementById('dictation').style.display = 'block';

            nextQuestion();
        }

        function nextQuestion() {
            if (currentIndex >= words.length) {
                showResults();
                return;
            }

            const word = words[currentIndex];
            document.getElementById('meaning').textContent = word.chn;
            document.getElementById('input').value = '';
            document.getElementById('input').classList.remove('correct', 'incorrect');
            document.getElementById('input').focus();

            playWord(); // 自动播放一次
            startTimer();
        }

        function playWord() {
            const word = words[currentIndex].eng;
            const utterance = new SpeechSynthesisUtterance(word);
            utterance.lang = 'en-US';
            speechSynthesis.speak(utterance);
        }

        function startTimer() {
            remainingTime = timerSetting;
            document.getElementById('timer').textContent = remainingTime;
            clearInterval(timerInterval);
            timerInterval = setInterval(() => {
                remainingTime--;
                document.getElementById('timer').textContent = remainingTime;
                if (remainingTime <= 0) {
                    handleIncorrect('超时');
                }
            }, 1000);
        }

        function submitAnswer() {
            const input = document.getElementById('input').value.trim().toLowerCase();
            const word = words[currentIndex].eng.toLowerCase();

            clearInterval(timerInterval);

            if (input === word) {
                correctCount++;
                document.getElementById('input').classList.add('correct');
                setTimeout(nextQuestion, 1000);
            } else {
                handleIncorrect('错误');
            }
            currentIndex++;
        }

        function skipQuestion() {
            clearInterval(timerInterval);
            handleIncorrect('跳过');
            currentIndex++;
            nextQuestion();
        }

        function handleIncorrect(reason) {
            const word = words[currentIndex];
            incorrect.push(word);
            document.getElementById('input').classList.add('incorrect');
            document.getElementById('input').value = word.eng; // 显示正确答案
            setTimeout(nextQuestion, 2000);
        }

        function showResults() {
            document.getElementById('dictation').style.display = 'none';
            document.getElementById('results').style.display = 'block';

            document.getElementById('total').textContent = words.length;
            document.getElementById('correct').textContent = correctCount;
            document.getElementById('incorrect-count').textContent = words.length - correctCount;
            document.getElementById('accuracy').textContent = Math.round((correctCount / words.length) * 100);

            const list = document.getElementById('result-list');
            list.innerHTML = '';
            incorrect.forEach(w => {
                const div = document.createElement('div');
                div.textContent = `错误单词: ${w.eng} (${w.chn})`;
                list.appendChild(div);
            });
        }

        function retry() {
            document.getElementById('results').style.display = 'none';
            document.getElementById('dictation').style.display = 'block';
            currentIndex = 0;
            correctCount = 0;
            incorrect = [];
            if (shuffle) {
                words = words.sort(() => Math.random() - 0.5);
            }
            nextQuestion();
        }

        function backToSetup() {
            document.getElementById('results').style.display = 'none';
            document.getElementById('setup').style.display = 'block';
            document.getElementById('word-list').value = '';
        }
    </script>
</body>
</html>
``````html
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>英语听写</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f0f8ff;
            color: #333;
            display: flex;
            justify-content: center;
            align-items: flex-start; /* 改为flex-start以避免内容过长时居中问题 */
            min-height: 100vh;
            margin: 0;
            padding: 20px;
            box-sizing: border-box;
            font-size: 1.2em;
        }
        .container {
            background-color: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            max-width: 600px;
            width: 100%;
            text-align: center;
            box-sizing: border-box;
        }
        textarea {
            width: 100%;
            height: 200px;
            margin-bottom: 10px;
            font-size: 1em;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 5px;
            box-sizing: border-box;
        }
        input[type="number"], input[type="checkbox"] {
            margin: 10px 0;
            font-size: 1em;
        }
        button {
            background-color: #4CAF50;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1em;
            margin: 10px 5px;
        }
        button:hover {
            background-color: #45a049;
        }
        #meaning {
            font-size: 2em;
            margin: 20px 0;
            word-wrap: break-word;
        }
        #input {
            width: 80%;
            padding: 10px;
            font-size: 1.5em;
            border: 2px solid #ccc;
            border-radius: 5px;
            text-align: center;
            box-sizing: border-box;
        }
        #timer {
            font-size: 1.5em;
            color: #ff4500;
            margin-left: 10px;
        }
        .correct {
            border-color: green !important;
            background-color: #e0ffe0 !important;
        }
        .incorrect {
            border-color: red !important;
            background-color: #ffe0e0 !important;
        }
        #result-list {
            text-align: left;
            margin: 20px 0;
        }
        #result-list div {
            margin: 5px 0;
            padding: 5px;
            background-color: #f9f9f9;
            border-radius: 5px;
            word-wrap: break-word;
        }
        #play-btn {
            background-color: #2196F3;
            margin: 10px 0;
        }
        #play-btn:hover {
            background-color: #1e88e5;
        }
        #skip-btn {
            background-color: #FFC107;
        }
        #skip-btn:hover {
            background-color: #ffb300;
        }
        #submit-btn {
            background-color: #4CAF50;
        }

        /* 响应式设计：适配手机端 */
        @media (max-width: 600px) {
            body {
                font-size: 1em;
                padding: 10px;
            }
            .container {
                padding: 15px;
            }
            #meaning {
                font-size: 1.5em;
            }
            #input {
                width: 100%;
                font-size: 1.2em;
                margin-bottom: 10px;
            }
            #timer {
                font-size: 1.2em;
                display: block; /* 计时器换行显示，避免错位 */
                margin: 10px 0;
            }
            button {
                width: 100%; /* 按钮全宽 */
                padding: 12px;
                font-size: 1em;
                margin: 5px 0;
            }
            textarea {
                height: 150px;
            }
        }
    </style>
</head>
<body>
    <div class="container" id="setup">
        <h1>设置界面</h1>
        <textarea id="word-list" placeholder="输入单词列表，每行一个，例如：&#10;apple 苹果&#10;banana 香蕉"></textarea>
        <label>倒计时（秒）：<input type="number" id="timer-setting" value="30" min="10"></label><br>
        <label>打乱顺序：<input type="checkbox" id="shuffle"></label><br>
        <button onclick="startDictation()">开始听写</button>
    </div>

    <div class="container" id="dictation" style="display: none;">
        <h1>听写界面</h1>
        <div id="meaning"></div>
        <button id="play-btn" onclick="playWord()">播放发音</button>
        <input type="text" id="input" placeholder="输入拼写" autofocus>
        <span id="timer"></span><br>
        <button id="submit-btn" onclick="submitAnswer()">提交</button>
        <button id="skip-btn" onclick="skipQuestion()">跳过</button>
    </div>

    <div class="container" id="results" style="display: none;">
        <h1>结果界面</h1>
        <p>总题数: <span id="total"></span></p>
        <p>正确数: <span id="correct"></span></p>
        <p>错误数: <span id="incorrect-count"></span></p>
        <p>正确率: <span id="accuracy"></span>%</p>
        <h2>错题回顾</h2>
        <div id="result-list"></div>
        <button onclick="retry()">再试一次</button>
        <button onclick="backToSetup()">返回主页</button>
    </div>

    <script>
        let words = [];
        let currentIndex = 0;
        let correctCount = 0;
        let incorrect = [];
        let timerInterval;
        let remainingTime;
        let timerSetting;
        let shuffle;

        function startDictation() {
            const list = document.getElementById('word-list').value.trim().split('\n');
            words = list.map(line => {
                const [eng, chn] = line.split(' ');
                return { eng, chn };
            }).filter(w => w.eng && w.chn);

            if (words.length === 0) {
                alert('请输入有效的单词列表！');
                return;
            }

            timerSetting = parseInt(document.getElementById('timer-setting').value) || 30;
            shuffle = document.getElementById('shuffle').checked;

            if (shuffle) {
                words = words.sort(() => Math.random() - 0.5);
            }

            currentIndex = 0;
            correctCount = 0;
            incorrect = [];

            document.getElementById('setup').style.display = 'none';
            document.getElementById('dictation').style.display = 'block';

            nextQuestion();
        }

        function nextQuestion() {
            if (currentIndex >= words.length) {
                showResults();
                return;
            }

            const word = words[currentIndex];
            document.getElementById('meaning').textContent = word.chn;
            document.getElementById('input').value = '';
            document.getElementById('input').classList.remove('correct', 'incorrect');
            document.getElementById('input').focus();

            playWord(); // 自动播放一次
            startTimer();
        }

        function playWord() {
            const word = words[currentIndex].eng;
            const utterance = new SpeechSynthesisUtterance(word);
            utterance.lang = 'en-US';
            speechSynthesis.speak(utterance);
        }

        function startTimer() {
            remainingTime = timerSetting;
            document.getElementById('timer').textContent = remainingTime;
            clearInterval(timerInterval);
            timerInterval = setInterval(() => {
                remainingTime--;
                document.getElementById('timer').textContent = remainingTime;
                if (remainingTime <= 0) {
                    handleIncorrect('超时');
                }
            }, 1000);
        }

        function submitAnswer() {
            const input = document.getElementById('input').value.trim().toLowerCase();
            const word = words[currentIndex].eng.toLowerCase();

            clearInterval(timerInterval);

            if (input === word) {
                correctCount++;
                document.getElementById('input').classList.add('correct');
                setTimeout(nextQuestion, 1000);
            } else {
                handleIncorrect('错误');
            }
            currentIndex++;
        }

        function skipQuestion() {
            clearInterval(timerInterval);
            handleIncorrect('跳过');
            currentIndex++;
            nextQuestion();
        }

        function handleIncorrect(reason) {
            const word = words[currentIndex];
            incorrect.push(word);
            document.getElementById('input').classList.add('incorrect');
            document.getElementById('input').value = word.eng; // 显示正确答案
            setTimeout(nextQuestion, 2000);
        }

        function showResults() {
            document.getElementById('dictation').style.display = 'none';
            document.getElementById('results').style.display = 'block';

            document.getElementById('total').textContent = words.length;
            document.getElementById('correct').textContent = correctCount;
            document.getElementById('incorrect-count').textContent = words.length - correctCount;
            document.getElementById('accuracy').textContent = Math.round((correctCount / words.length) * 100);

            const list = document.getElementById('result-list');
            list.innerHTML = '';
            incorrect.forEach(w => {
                const div = document.createElement('div');
                div.textContent = `错误单词: ${w.eng} (${w.chn})`;
                list.appendChild(div);
            });
        }

        function retry() {
            document.getElementById('results').style.display = 'none';
            document.getElementById('dictation').style.display = 'block';
            currentIndex = 0;
            correctCount = 0;
            incorrect = [];
            if (shuffle) {
                words = words.sort(() => Math.random() - 0.5);
            }
            nextQuestion();
        }

        function backToSetup() {
            document.getElementById('results').style.display = 'none';
            document.getElementById('setup').style.display = 'block';
            document.getElementById('word-list').value = '';
        }
    </script>
</body>
</html>
``` html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>英语单词听写</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            color: #333;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 20px;
            font-size: 16px;
            line-height: 1.6;
        }
        .container {
            background-color: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            width: 100%;
            max-width: 600px;
            text-align: center;
            transition: all 0.3s ease;
        }
        h1 {
            color: #2c3e50;
            margin-bottom: 20px;
            font-size: 2.2em;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
        }
        h2 {
            color: #2c3e50;
            margin: 20px 0 15px;
            font-size: 1.8em;
        }
        textarea {
            width: 100%;
            height: 200px;
            margin: 15px 0;
            font-size: 1.1em;
            padding: 15px;
            border: 2px solid #ddd;
            border-radius: 8px;
            resize: vertical;
            transition: border-color 0.3s;
        }
        textarea:focus {
            outline: none;
            border-color: #3498db;
        }
        label {
            display: block;
            margin: 15px 0;
            font-size: 1.1em;
            color: #2c3e50;
            font-weight: 500;
        }
        input[type="number"] {
            width: 80px;
            padding: 8px;
            font-size: 1em;
            border: 2px solid #ddd;
            border-radius: 5px;
            text-align: center;
        }
        input[type="checkbox"] {
            transform: scale(1.3);
            margin-right: 10px;
        }
        input[type="text"] {
            width: 80%;
            padding: 15px;
            font-size: 1.3em;
            border: 2px solid #ddd;
            border-radius: 8px;
            text-align: center;
            margin: 15px 0;
            transition: all 0.3s;
        }
        input[type="text"]:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.2);
        }
        button {
            background-color: #3498db;
            color: white;
            padding: 12px 25px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1.1em;
            margin: 10px;
            transition: all 0.3s;
            font-weight: 500;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 8px rgba(0, 0, 0, 0.15);
        }
        button:active {
            transform: translateY(0);
        }
        #play-btn {
            background-color: #2ecc71;
        }
        #play-btn:hover {
            background-color: #27ae60;
        }
        #skip-btn {
            background-color: #e74c3c;
        }
        #skip-btn:hover {
            background-color: #c0392b;
        }
        #submit-btn {
            background-color: #3498db;
        }
        #submit-btn:hover {
            background-color: #2980b9;
        }
        #meaning {
            font-size: 2.2em;
            margin: 25px 0;
            color: #2c3e50;
            font-weight: 600;
            min-height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        #timer {
            font-size: 1.5em;
            color: #e74c3c;
            font-weight: bold;
            margin: 15px 0;
            display: inline-block;
            background: #ffeaa7;
            padding: 5px 15px;
            border-radius: 20px;
        }
        .correct {
            border-color: #2ecc71 !important;
            background-color: #d5f4e6 !important;
        }
        .incorrect {
            border-color: #e74c3c !important;
            background-color: #fadbd8 !important;
        }
        #result-list {
            text-align: left;
            margin: 20px 0;
            max-height: 300px;
            overflow-y: auto;
        }
        #result-list div {
            margin: 8px 0;
            padding: 12px;
            background-color: #f8f9fa;
            border-radius: 8px;
            border-left: 4px solid #e74c3c;
            font-size: 1.1em;
        }
        .stats {
            display: flex;
            justify-content: space-around;
            margin: 20px 0;
            flex-wrap: wrap;
        }
        .stat-item {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            min-width: 120px;
            margin: 10px;
            box-shadow: 0 3px 5px rgba(0, 0, 0, 0.05);
        }
        .stat-value {
            font-size: 2em;
            font-weight: bold;
            color: #3498db;
        }
        #accuracy .stat-value {
            color: #2ecc71;
        }
        .instructions {
            background: #e8f4fc;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            text-align: left;
            font-size: 0.95em;
        }
        .instructions h3 {
            margin-bottom: 10px;
            color: #2980b9;
        }
        .instructions ul {
            padding-left: 20px;
        }
        .instructions li {
            margin: 5px 0;
        }
        @media (max-width: 600px) {
            .container {
                padding: 20px;
            }
            h1 {
                font-size: 1.8em;
            }
            button {
                display: block;
                width: 100%;
                margin: 10px 0;
            }
            .stats {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="container" id="setup">
        <h1>英语单词听写</h1>
        
        <div class="instructions">
            <h3>使用说明</h3>
            <ul>
                <li>在下方输入单词列表，格式为：英文 中文（每行一个单词）</li>
                <li>设置每题答题时间（秒）</li>
                <li>可选择是否打乱单词顺序</li>
                <li>点击"开始听写"进入听写界面</li>
            </ul>
        </div>
        
        <textarea id="word-list" placeholder="请输入单词列表，每行一个，格式为：英文 中文&#10;例如：&#10;apple 苹果&#10;banana 香蕉&#10;computer 计算机"></textarea>
        
        <label for="timer-setting">每题答题时间（秒）：</label>
        <input type="number" id="timer-setting" value="30" min="10" max="120">
        
        <label for="shuffle">
            <input type="checkbox" id="shuffle" checked> 打乱单词顺序
        </label>
        
        <button onclick="startDictation()">开始听写</button>
    </div>

    <div class="container" id="dictation" style="display: none;">
        <h1>单词听写</h1>
        <div id="meaning"></div>
        <button id="play-btn" onclick="playWord()">🔊 播放发音</button>
        <input type="text" id="input" placeholder="请输入英文拼写" autofocus>
        <div id="timer"></div>
        <button id="submit-btn" onclick="submitAnswer()">提交答案</button>
        <button id="skip-btn" onclick="skipQuestion()">跳过此题</button>
    </div>

    <div class="container" id="results" style="display: none;">
        <h1>听写结果</h1>
        
        <div class="stats">
            <div class="stat-item">
                <div>总题数</div>
                <div class="stat-value" id="total">0</div>
            </div>
            <div class="stat-item">
                <div>正确数</div>
                <div class="stat-value" id="correct">0</div>
            </div>
            <div class="stat-item">
                <div>错误数</div>
                <div class="stat-value" id="incorrect-count">0</div>
            </div>
            <div class="stat-item" id="accuracy">
                <div>正确率</div>
                <div class="stat-value">0%</div>
            </div>
        </div>
        
        <h2>错题回顾</h2>
        <div id="result-list"></div>
        
        <button onclick="retry()">再试一次</button>
        <button onclick="backToSetup()">返回主页</button>
    </div>

    <script>
        let words = [];
        let currentIndex = 0;
        let correctCount = 0;
        let incorrect = [];
        let timerInterval;
        let remainingTime;
        let timerSetting;
        let shuffle;

        function startDictation() {
            const list = document.getElementById('word-list').value.trim().split('\n');
            words = [];
            
            for (let i = 0; i < list.length; i++) {
                const line = list[i].trim();
                if (line) {
                    // 更健壮的解析方式，处理多个空格情况
                    const parts = line.split(/\s+/);
                    if (parts.length >= 2) {
                        const english = parts[0];
                        const chinese = parts.slice(1).join(' ');
                        words.push({ eng: english, chn: chinese });
                    }
                }
            }

            if (words.length === 0) {
                alert('请输入有效的单词列表！\n格式为：英文 中文（每行一个单词）');
                return;
            }

            timerSetting = parseInt(document.getElementById('timer-setting').value) || 30;
            if (timerSetting < 10) timerSetting = 10;
            if (timerSetting > 120) timerSetting = 120;
            
            shuffle = document.getElementById('shuffle').checked;

            if (shuffle) {
                // 更均匀的洗牌算法
                for (let i = words.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [words[i], words[j]] = [words[j], words[i]];
                }
            }

            currentIndex = 0;
            correctCount = 0;
            incorrect = [];

            document.getElementById('setup').style.display = 'none';
            document.getElementById('dictation').style.display = 'block';

            nextQuestion();
        }

        function nextQuestion() {
            if (currentIndex >= words.length) {
                showResults();
                return;
            }

            const word = words[currentIndex];
            document.getElementById('meaning').textContent = word.chn;
            document.getElementById('input').value = '';
            document.getElementById('input').classList.remove('correct', 'incorrect');
            document.getElementById('input').focus();

            playWord(); // 自动播放一次
            startTimer();
        }

        function playWord() {
            const word = words[currentIndex].eng;
            const utterance = new SpeechSynthesisUtterance(word);
            utterance.lang = 'en-US';
            utterance.rate = 0.9; // 稍微放慢语速
            speechSynthesis.speak(utterance);
        }

        function startTimer() {
            remainingTime = timerSetting;
            updateTimerDisplay();
            clearInterval(timerInterval);
            timerInterval = setInterval(() => {
                remainingTime--;
                updateTimerDisplay();
                if (remainingTime <= 0) {
                    clearInterval(timerInterval);
                    handleIncorrect('超时');
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const timerElement = document.getElementById('timer');
            timerElement.textContent = `剩余时间: ${remainingTime}秒`;
            
            // 根据剩余时间改变颜色
            if (remainingTime <= 10) {
                timerElement.style.color = '#e74c3c';
                timerElement.style.background = '#ff7979';
            } else if (remainingTime <= 20) {
                timerElement.style.color = '#f39c12';
                timerElement.style.background = '#f6e58d';
            } else {
                timerElement.style.color = '#2ecc71';
                timerElement.style.background = '#abebc6';
            }
        }

        function submitAnswer() {
            const input = document.getElementById('input').value.trim().toLowerCase();
            const word = words[currentIndex].eng.toLowerCase();

            clearInterval(timerInterval);

            if (input === word) {
                correctCount++;
                document.getElementById('input').classList.add('correct');
                currentIndex++;
                setTimeout(nextQuestion, 1000);
            } else {
                handleIncorrect('错误');
            }
        }

        function skipQuestion() {
            clearInterval(timerInterval);
            handleIncorrect('跳过');
            currentIndex++;
            setTimeout(nextQuestion, 500);
        }

        function handleIncorrect(reason) {
            const word = words[currentIndex];
            incorrect.push({...word, reason});
            document.getElementById('input').classList.add('incorrect');
            document.getElementById('input').value = word.eng; // 显示正确答案
        }

        function showResults() {
            document.getElementById('dictation').style.display = 'none';
            document.getElementById('results').style.display = 'block';

            const total = words.length;
            const incorrectCount = total - correctCount;
            const accuracy = Math.round((correctCount / total) * 100);

            document.getElementById('total').textContent = total;
            document.getElementById('correct').textContent = correctCount;
            document.getElementById('incorrect-count').textContent = incorrectCount;
            document.getElementById('accuracy').querySelector('.stat-value').textContent = `${accuracy}%`;

            const list = document.getElementById('result-list');
            list.innerHTML = '';
            
            if (incorrect.length === 0) {
                list.innerHTML = '<div style="text-align: center; color: #2ecc71; border-left-color: #2ecc71;">太棒了！全部正确！</div>';
            } else {
                incorrect.forEach((w, index) => {
                    const div = document.createElement('div');
                    div.innerHTML = `<strong>${index + 1}.</strong> ${w.eng} - ${w.chn} <span style="color: #e74c3c; font-size: 0.9em;">(${w.reason})</span>`;
                    list.appendChild(div);
                });
            }
        }

        function retry() {
            document.getElementById('results').style.display = 'none';
            document.getElementById('dictation').style.display = 'block';
            currentIndex = 0;
            correctCount = 0;
            incorrect = [];
            if (shuffle) {
                for (let i = words.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [words[i], words[j]] = [words[j], words[i]];
                }
            }
            nextQuestion();
        }

        function backToSetup() {
            document.getElementById('results').style.display = 'none';
            document.getElementById('setup').style.display = 'block';
        }

        // 添加键盘快捷键支持
        document.addEventListener('keydown', function(event) {
            // 在听写界面时
            if (document.getElementById('dictation').style.display !== 'none') {
                if (event.key === 'Enter') {
                    submitAnswer();
                } else if (event.key === ' ') {
                    event.preventDefault(); // 防止空格键滚动页面
                    playWord();
                } else if (event.key === 'Escape') {
                    skipQuestion();
                }
            }
        });
    </script>
</body>
</html>        .button-group {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 30px;
        }
        
        button {
            padding: 12px 25px;
            border: none;
            border-radius: 50px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .btn-primary {
            background: linear-gradient(to right, #6a11cb, #2575fc);
            color: white;
        }
        
        .btn-secondary {
            background: #f0f0f0;
            color: #333;
        }
        
        .btn-success {
            background: #4CAF50;
            color: white;
        }
        
        .btn-danger {
            background: #f44336;
            color: white;
        }
        
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        button:active {
            transform: translateY(0);
        }
        
        /* 听写界面样式 */
        .dictation-area {
            text-align: center;
            padding: 20px 0;
        }
        
        .meaning {
            font-size: 28px;
            margin-bottom: 20px;
            color: #333;
            min-height: 40px;
        }
        
        .word-input {
            margin: 20px 0;
        }
        
        .timer {
            font-size: 24px;
            font-weight: bold;
            color: #2575fc;
            margin: 15px 0;
        }
        
        .controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 20px;
        }
        
        .feedback {
            height: 30px;
            margin: 10px 0;
            font-weight: bold;
            transition: all 0.3s;
        }
        
        .correct {
            color: #4CAF50;
        }
        
        .incorrect {
            color: #f44336;
        }
        
        /* 结果界面样式 */
        .results-summary {
            display: flex;
            justify-content: space-around;
            margin: 30px 0;
            flex-wrap: wrap;
        }
        
        .result-item {
            text-align: center;
            padding: 15px;
            border-radius: 10px;
            background: #f9f9f9;
            flex: 1;
            margin: 10px;
            min-width: 150px;
        }
        
        .result-value {
            font-size: 32px;
            font-weight: bold;
            margin: 10px 0;
        }
        
        .result-label {
            font-size: 16px;
            color: #666;
        }
        
        .correct-count .result-value {
            color: #4CAF50;
        }
        
        .wrong-count .result-value {
            color: #f44336;
        }
        
        .accuracy .result-value {
            color: #2575fc;
        }
        
        .wrong-words-list {
            margin: 30px 0;
        }
        
        .wrong-word-item {
            padding: 15px;
            border-bottom: 1px solid #f0f0f0;
            display: flex;
            justify-content: space-between;
        }
        
        .word-spelling {
            font-weight: bold;
        }
        
        .word-meaning {
            color: #666;
        }
        
        /* 响应式设计 */
        @media (max-width: 600px) {
            .container {
                border-radius: 10px;
            }
            
            .page {
                padding: 20px 15px;
            }
            
            h1 {
                font-size: 1.8rem;
            }
            
            .results-summary {
                flex-direction: column;
            }
            
            .button-group, .controls {
                flex-direction: column;
            }
            
            button {
                width: 100%;
            }
        }
        
        /* 语音按钮样式 */
        .speak-btn {
            background: #ff9800;
            color: white;
            border-radius: 50%;
            width: 60px;
            height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 20px;
            cursor: pointer;
            font-size: 24px;
            box-shadow: 0 4px 10px rgba(255, 152, 0, 0.3);
        }
        
        .progress-bar {
            height: 10px;
            background: #f0f0f0;
            border-radius: 5px;
            margin: 20px 0;
            overflow: hidden;
        }
        
        .progress {
            height: 100%;
            background: linear-gradient(to right, #6a11cb, #2575fc);
            width: 0%;
            transition: width 0.3s;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- 设置界面 -->
        <div id="setup-page" class="page active">
            <h1>英语单词听写</h1>
            <p class="subtitle">老师设置 - 创建单词列表</p>
            
            <div class="form-group">
                <label for="word-list">单词列表（格式：英文 中文，每行一个单词）</label>
                <textarea id="word-list" placeholder="例如：
apple 苹果
banana 香蕉
orange 橙子
computer 电脑
...">apple 苹果
banana 香蕉
orange 橙子
computer 电脑
school 学校
teacher 老师
student 学生
book 书
pen 钢笔
pencil 铅笔</textarea>
            </div>
            
            <div class="form-group">
                <label for="countdown-time">每道题作答时间（秒）</label>
                <input type="number" id="countdown-time" min="5" max="120" value="30">
            </div>
            
            <div class="checkbox-group">
                <input type="checkbox" id="shuffle-words">
                <label for="shuffle-words">打乱单词顺序</label>
            </div>
            
            <div class="button-group">
                <button id="start-btn" class="btn-primary">开始听写</button>
            </div>
        </div>
        
        <!-- 听写界面 -->
        <div id="dictation-page" class="page">
            <h1>英语单词听写</h1>
            <div class="progress-bar">
                <div class="progress" id="progress-bar"></div>
            </div>
            
            <div class="dictation-area">
                <div class="meaning" id="word-meaning">准备中...</div>
                
                <div class="speak-btn" id="speak-btn">🔊</div>
                
                <div class="word-input">
                    <input type="text" id="answer-input" placeholder="请输入您听到的单词" autocomplete="off">
                </div>
                
                <div class="timer" id="timer">30</div>
                
                <div class="feedback" id="feedback"></div>
                
                <div class="controls">
                    <button id="submit-btn" class="btn-primary">提交</button>
                    <button id="skip-btn" class="btn-secondary">跳过</button>
                </div>
            </div>
        </div>
        
        <!-- 结果界面 -->
        <div id="result-page" class="page">
            <h1>听写结果</h1>
            
            <div class="results-summary">
                <div class="result-item total-count">
                    <div class="result-value" id="total-count">0</div>
                    <div class="result-label">总题数</div>
                </div>
                
                <div class="result-item correct-count">
                    <div class="result-value" id="correct-count">0</div>
                    <div class="result-label">正确数</div>
                </div>
                
                <div class="result-item wrong-count">
                    <div class="result-value" id="wrong-count">0</div>
                    <div class="result-label">错误数</div>
                </div>
                
                <div class="result-item accuracy">
                    <div class="result-value" id="accuracy">0%</div>
                    <div class="result-label">正确率</div>
                </div>
            </div>
            
            <h2>错题回顾</h2>
            <div class="wrong-words-list" id="wrong-words-list">
                <!-- 错题将在这里动态生成 -->
            </div>
            
            <div class="button-group">
                <button id="try-again-btn" class="btn-primary">再试一次</button>
                <button id="back-to-setup-btn" class="btn-secondary">返回主页</button>
            </div>
        </div>
    </div>

    <script>
        // 页面元素
        const setupPage = document.getElementById('setup-page');
        const dictationPage = document.getElementById('dictation-page');
        const resultPage = document.getElementById('result-page');
        
        const wordListTextarea = document.getElementById('word-list');
        const countdownTimeInput = document.getElementById('countdown-time');
        const shuffleWordsCheckbox = document.getElementById('shuffle-words');
        const startBtn = document.getElementById('start-btn');
        
        const wordMeaning = document.getElementById('word-meaning');
        const speakBtn = document.getElementById('speak-btn');
        const answerInput = document.getElementById('answer-input');
        const timerDisplay = document.getElementById('timer');
        const feedback = document.getElementById('feedback');
        const submitBtn = document.getElementById('submit-btn');
        const skipBtn = document.getElementById('skip-btn');
        const progressBar = document.getElementById('progress-bar');
        
        const totalCount = document.getElementById('total-count');
        const correctCount = document.getElementById('correct-count');
        const wrongCount = document.getElementById('wrong-count');
        const accuracy = document.getElementById('accuracy');
        const wrongWordsList = document.getElementById('wrong-words-list');
        const tryAgainBtn = document.getElementById('try-again-btn');
        const backToSetupBtn = document.getElementById('back-to-setup-btn');
        
        // 应用状态
        let words = [];
        let currentWordIndex = 0;
        let correctAnswers = 0;
        let wrongAnswers = 0;
        let countdownTime = 30;
        let timer;
        let currentWordObj = null;
        let wrongWords = [];
        
        // 初始化
        document.addEventListener('DOMContentLoaded', function() {
            // 绑定按钮事件
            startBtn.addEventListener('click', startDictation);
            submitBtn.addEventListener('click', checkAnswer);
            skipBtn.addEventListener('click', skipWord);
            speakBtn.addEventListener('click', speakCurrentWord);
            tryAgainBtn.addEventListener('click', tryAgain);
            backToSetupBtn.addEventListener('click', backToSetup);
            
            // 输入框回车提交
            answerInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    checkAnswer();
                }
            });
        });
        
        // 开始听写
        function startDictation() {
            // 解析单词列表
            const wordListText = wordListTextarea.value.trim();
            if (!wordListText) {
                alert('请输入单词列表！');
                return;
            }
            
            const lines = wordListText.split('\n');
            words = [];
            
            for (let line of lines) {
                line = line.trim();
                if (!line) continue;
                
                // 简单的解析逻辑：第一个空格前是英文，后面是中文
                const firstSpaceIndex = line.indexOf(' ');
                if (firstSpaceIndex === -1) continue;
                
                const english = line.substring(0, firstSpaceIndex).trim();
                const chinese = line.substring(firstSpaceIndex + 1).trim();
                
                if (english && chinese) {
                    words.push({ english, chinese });
                }
            }
            
            if (words.length === 0) {
                alert('没有找到有效的单词！请确保使用"英文 中文"的格式，每行一个单词。');
                return;
            }
            
            // 获取设置
            countdownTime = parseInt(countdownTimeInput.value) || 30;
            const shuffle = shuffleWordsCheckbox.checked;
            
            // 打乱顺序（如果需要）
            if (shuffle) {
                shuffleArray(words);
            }
            
            // 重置状态
            currentWordIndex = 0;
            correctAnswers = 0;
            wrongAnswers = 0;
            wrongWords = [];
            
            // 切换到听写界面
            switchPage(dictationPage);
            
            // 开始第一个单词
            nextWord();
        }
        
        // 切换到下一个单词
        function nextWord() {
            if (currentWordIndex >= words.length) {
                // 听写结束，显示结果
                showResults();
                return;
            }
            
            // 更新进度条
            const progress = (currentWordIndex / words.length) * 100;
            progressBar.style.width = `${progress}%`;
            
            // 获取当前单词
            currentWordObj = words[currentWordIndex];
            
            // 显示中文意思
            wordMeaning.textContent = currentWordObj.chinese;
            
            // 清空输入框和反馈
            answerInput.value = '';
            feedback.textContent = '';
            answerInput.style.borderColor = '#ddd';
            
            // 聚焦输入框
            answerInput.focus();
            
            // 自动朗读单词
            speakCurrentWord();
            
            // 开始倒计时
            startTimer();
        }
        
        // 朗读当前单词
        function speakCurrentWord() {
            if (!currentWordObj) return;
            
            // 使用Web Speech API朗读单词[1,4](@ref)
            if ('speechSynthesis' in window) {
                const utterance = new SpeechSynthesisUtterance(currentWordObj.english);
                utterance.lang = 'en-US';
                utterance.rate = 0.9; // 稍微放慢语速，适合小学生
                
                // 尝试设置英式发音
                const voices = speechSynthesis.getVoices();
                const englishVoice = voices.find(voice => 
                    voice.lang.includes('en') && voice.name.includes('GB')
                );
                
                if (englishVoice) {
                    utterance.voice = englishVoice;
                }
                
                speechSynthesis.speak(utterance);
            } else {
                // 浏览器不支持语音合成
                feedback.textContent = '您的浏览器不支持语音朗读功能';
                feedback.className = 'feedback incorrect';
            }
        }
        
        // 开始倒计时
        function startTimer() {
            let timeLeft = countdownTime;
            timerDisplay.textContent = timeLeft;
            
            clearInterval(timer);
            timer = setInterval(() => {
                timeLeft--;
                timerDisplay.textContent = timeLeft;
                
                if (timeLeft <= 0) {
                    clearInterval(timer);
                    // 时间到，自动提交错误答案
                    handleWrongAnswer('时间到！');
                }
            }, 1000);
        }
        
        // 检查答案
        function checkAnswer() {
            const userAnswer = answerInput.value.trim().toLowerCase();
            const correctAnswer = currentWordObj.english.toLowerCase();
            
            clearInterval(timer);
            
            if (userAnswer === correctAnswer) {
                // 答案正确
                handleCorrectAnswer();
            } else {
                // 答案错误
                handleWrongAnswer(`正确答案: ${currentWordObj.english}`);
            }
        }
        
        // 处理正确答案
        function handleCorrectAnswer() {
            correctAnswers++;
            feedback.textContent = '正确！';
            feedback.className = 'feedback correct';
            answerInput.style.borderColor = '#4CAF50';
            
            setTimeout(() => {
                currentWordIndex++;
                nextWord();
            }, 1000);
        }
        
        // 处理错误答案
        function handleWrongAnswer(message) {
            wrongAnswers++;
            wrongWords.push(currentWordObj);
            
            feedback.textContent = message;
            feedback.className = 'feedback incorrect';
            answerInput.style.borderColor = '#f44336';
            
            setTimeout(() => {
                currentWordIndex++;
                nextWord();
            }, 1500);
        }
        
        // 跳过单词
        function skipWord() {
            clearInterval(timer);
            handleWrongAnswer(`已跳过，正确答案: ${currentWordObj.english}`);
        }
        
        // 显示结果
        function showResults() {
            // 切换到结果界面
            switchPage(resultPage);
            
            // 更新结果统计
            totalCount.textContent = words.length;
            correctCount.textContent = correctAnswers;
            wrongCount.textContent = wrongAnswers;
            
            const accuracyValue = words.length > 0 ? Math.round((correctAnswers / words.length) * 100) : 0;
            accuracy.textContent = `${accuracyValue}%`;
            
            // 显示错题列表
            wrongWordsList.innerHTML = '';
            
            if (wrongWords.length === 0) {
                wrongWordsList.innerHTML = '<p style="text-align:center; color:#666;">太棒了！没有错题！</p>';
            } else {
                wrongWords.forEach(word => {
                    const item = document.createElement('div');
                    item.className = 'wrong-word-item';
                    item.innerHTML = `
                        <div>
                            <span class="word-spelling">${word.english}</span>
                            <span class="word-meaning">${word.chinese}</span>
                        </div>
                    `;
                    wrongWordsList.appendChild(item);
                });
            }
        }
        
        // 再试一次
        function tryAgain() {
            // 使用相同的设置重新开始
            currentWordIndex = 0;
            correctAnswers = 0;
            wrongAnswers = 0;
            wrongWords = [];
            
            switchPage(dictationPage);
            nextWord();
        }
        
        // 返回设置界面
        function backToSetup() {
            switchPage(setupPage);
        }
        
        // 切换页面
        function switchPage(pageToShow) {
            setupPage.classList.remove('active');
            dictationPage.classList.remove('active');
            resultPage.classList.remove('active');
            
            pageToShow.classList.add('active');
        }
        
        // 打乱数组顺序[2](@ref)
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }
        
        // 初始化语音合成API[1](@ref)
        window.speechSynthesis.onvoiceschanged = function() {
            // 语音列表加载完成
        };
    </script>
</body>
</html>
